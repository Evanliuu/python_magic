# -*- coding:utf-8 -*-
import numpy as np
import jieba

from wordcloud import WordCloud
from matplotlib import pyplot as plt
from PIL import Image

__author__ = 'Evan'


TXT = """春风三月，春雨霏霏，有时三点两点雨，到处十枝五枝花的景象拂入脑海，深知，此时已是草长莺飞的明媚时节，故乡便踩着春风的节拍送入眼帘。

故乡是一个有溪有水有野趣的静美之地，可那仅仅是在记忆之上。

记忆中，小桥，流水，院落，原野与宽广与悠长构成一幅三维而多彩的田园风景画。

故乡有一条小河，那时它是一条不知名的小溪河，多少年来躺在地球的一角，既无大江大河的奔腾汹涌，也无沧海桑田的宽广深厚，但却默默无闻、无怨无悔地把自己的每一滴甘露献给了大地，献给了小河流经之地的人们

无名的小河，流经之地水质清澈、溪草茂密，河岸滩、石密集，河边柳竹成行，小河在柳竹的庇护下摆出一幅巨大洗练的银带一路向前，悠长宽广的一幅江南溪涧美景，一览无余的呈现，这样的景致总唤起人们美好的遐思与向往，于是，便有了依水而居的人家。

故乡因水而妩媚，乡间因桥而多情。

有水就定会有桥，水隔一方，桥连一脉，有了桥才有了生活的起伏和变化。

在河岸较窄的地方，一石板桥横亘于小河之上，远远看去，小桥厚厚墩墩，结实无比，三根桥柱牢固地支撑着上面敦实厚重的桥板。小桥很平常，长不足十米，宽约两米，在广袤的农村，实属常见。但小桥却透出淡淡的质朴与古老，说它是石板桥，但经过岁月的洗涤却变成一条石沟桥，桥面被历史的刀锋深深的剜去形成一道沟壑，向世人道出小桥厚重的历史与沧桑。尽管人们总抱怨桥面倾斜，走着不那么舒适坦然，但只有桥墩仍忠贞的、小心翼翼地守护着这古老而坚强的小桥，一如守护自己婴孩般的专注与刚强。

据老辈人讲，这座小桥相脉承的石板路，是著名的宗大路，它起自何方，我不知晓，可路向北再行60里地便是大足县城，再向北行20多里为宝顶山大佛湾，那是世界文化遗产所在地。大足及那的石刻因路增添诸多神秘，路因石刻蒙上多彩的外衣，于是便蹴就孩童们从小就爱听老辈们讲的传奇故事，思绪也总在古战马是如何膘悍与强壮、乾隆皇帝下江南又是何等的盛世空前、安史之乱中的工匠是如何逃往那偏远之地开凿石像的等等如影随形的暇想中荡来荡去，如电影镜头般从脑海划过，让人痴迷，让人费解。但不管老辈们讲的传奇是如何精彩，是否属实，但至少这曾是古驿道，该是千真万确的，桥面的沟壑正是当年铁蹄踩踏下一道无法抹去的铁证。

庆幸的是，忠厚的小桥不孤单，那时小桥两头岸石叠加，石依水而生，依岸而立，两棵参天榕树紧紧拥抱着坚硬的石坡，才使小桥有了铁定的基石与依靠，经风遇雨接受着时间的磨砺，使小桥突显几分韵致与质朴。小桥一端的榕树下，修有小房一间，为明清时期的青色砖瓦砌成，房内沿墙根修有马蹄形的石凳，老辈人说那是专为路人休憩而建的。小桥、大树、小房子、大石坡、小石块、流水、农家院落便组成一幅极具田园风光的乡间美景，于是这里的人们便以此为乐园，释放着心中的欢快与喜悦。

从上而下的流水经历一路的艰辛与洗涤，明澈而亮丽，清爽而甘甜，这是上天赐予的人间甘露。每每到春夏，溪美人畅，看水里的鱼儿浅戏水草，观桥下流水峰回路转，看柳竹倒映河水的妩媚，逐柳絮飞舞的欢畅，都是农家人的乐子，农家院落里的大人孩子，便尽享这天赐的纯净与美好，于是寂静的乡间有了欢笑，生出了遐想，便有了一幅幅晨洗及晚霞落尘时的洗衣、淘菜、锄犁、浇灌、洗澡、捕鱼、打闹的人间美景，这样人欢溪畅、人勤春早的景致，总让世人羡慕与前往。在离小桥两里地的几幢高楼里的富家子弟再也不闲置，邀三约四，欣然的前来，伴随他们的还有那偏分头、喇叭裤、花衬衫、连衣裙、高跟鞋和带有几分挑逗的爱情歌曲，刺激并入侵着乡间人的思想和神经，把带有几分羞涩的乡间妹子和小伙那种欲近又惧的落寞与惆怅提到极致，时时燃起乡间夜晚的梦呓，装点着年轻人的梦想。

可是这样的场景在记忆中并存的岁月短暂而苍凉，时代变迁，小河有了名姓，曰沱江水系的小安溪河，并用代号给予了标注，其流入的是滔滔的长江母亲河。代号给予了小河的姓名，却给予不了故乡人的幸福，有名有姓的小河也生活得并不那么开心快乐。着先是河岸的人家将坚硬的石头开凿成条，纷纷搬自家院落，做着修房造屋的基料，农家人住上了新房，而大榕树却缺少了根基，不是被暴雨盘根拔起，就是孤单萎靡而去;再不久小河的上游有了工厂，耸立起了大烟囱，乡间有了诸多喧嚣，田园风景有了诸多杂乱无章，清澈的溪水消逝，水草糜烂，鱼儿翻转着鱼肚，溪水散发着腥味，农家人失去了生存和发展的源泉，随后，两岸修葺的楼房人去楼空，仅留下年长者孤单的守护着它的辉煌与苍凉。

这样的侵占与剥夺无休无止，推土机、压路机的吼声宏大如钟，迫击着故乡人的心灵，驱赶着故乡人的生活，看着母亲愁容满面的脸颊，便知故乡那七八个星天外，两三点雨山前的胜景，将永远封存在记忆深处了!"""


def generate_word_cloud(background_image='', save_file_name=''):
    """
    读取文本信息生成词云图
    :param background_image: 词云背景图片
    :param save_file_name: 保存图片的名称
    :return:
    """
    if background_image:
        img = Image.open(background_image)  # 读取本地图片
        img_array = np.array(img)  # 将图片装换为数组
    else:
        img_array = None
    wc = WordCloud(background_color='white',
                   width=600,
                   height=800,
                   mask=img_array,  # 添加图片背景框
                   font_path=r'C:\Windows\Fonts\simkai.ttf',  # 如果是中文必须要添加这个，否则会显示成框框
                   max_words=2000,  # 设置最大字数
                   random_state=30,  # 设置有多少种随机生成状态，即有多少种配色方案
                   )
    text = ' '.join(jieba.cut(TXT))  # 使用jieba分词，精确模式切分
    wc.generate_from_text(text)  # 生成词云
    plt.imshow(wc)  # 使用plt加载图片
    plt.axis('off')  # 不显示坐标轴
    plt.show()  # 预览图片
    if save_file_name:
        wc.to_file(save_file_name)  # 保存词云图片到本地


if __name__ == '__main__':
    generate_word_cloud(background_image='background.jpg')
